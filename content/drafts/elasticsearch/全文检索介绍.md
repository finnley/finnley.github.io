+++
title = '全文检索介绍'
date = 2019-04-01T02:08:51+08:00
draft = true
categories = [ "ElasticSearch" ]
tags = [ "es" ]
+++

## 数据分类

* 结构化数据

行数据，存储在数据库中，可以用二维表结构来逻辑表达实现的数据（能够用数据或者同意的结构加以表示， 比如数字、符号等， 商品库存使用数字来表示，商品价格使用浮点数据来表示）

* 非结构化数据

无法用数字或者同意的结构来表示的数据（比如文本，图像，声音，网页等），结构化数据属于非结构化数据，比如商品的标题，商品的描述等都属于文本。

非结构化数据就是全文数据，对全文数据的检索就是全文检索

## 概念

一种将文件中或者数据库中所有文本与检索项匹配的文字资料检索方法。
对全文数据的检索

## 全文检索

* 顺序扫描法

会将数据表中的所有记录挨个进行扫描，然后在对每一条记录里的内容逐字扫描，把要搜索的内容搜索出来。这种方式速度很慢，效率非常低下。

* 索引扫描法

全文检索的基本思路，也即将非架构话数据中一部分信息提取出来，重新组织，使其变得有一定结构，然后对此有一定结构的数据进行搜索，从而达到搜索相对较快的目的。

## 全文检索过程

1. 索引创建

索引保存了什么？其实索引就是一个字典，它里面保存了词源对应的文档ID。

索引的搜索的时候是不是还要进行索引的创建？然后再根据索引进行搜索。这个不用，因为索引的创建只会创建一次。

* 如何创建索引

第一步：将一些我们需要的创建的文本拿出来（一些要索引的原文档（Document））

第二步：将原文档传给分词组件（Tokenizer）

    分词组件会将文档分成一个一个单独的单词
    去除里面的标点符号
    去除停词（Stop word,比如 a, the这些没有意义的词）
    最终得到词元

第三步：将得到的词元（Token）传给语言处理组件（Linguistic Processor）

    会将得到的词元转为小写（Lowercase）
    将单词缩减为词的形式，如 “cars” 转为 “car” 等
    将单词转变为词根的形式，如 “drove” 转为 “drive” 等（过去式转为一般式）

第四步： 将得到的词（Term）传给索引组件（Indexer）

    利用得到的词（Term）创建一个字典
    对字典按字母顺序排序
    合并相同的词（Term）成为文档倒排（Posting List）链表


2. 搜索索引

* 如何搜索索引

第一步： 用户输入查询语句

第二步： 对查询语句进行词法分析，语法分析，及语言处理

第三步： 搜索索引，得到符合文档ID，再根据文档ID得到索引结果

## 全文检索引擎

全文检索引擎是目前广泛应用的主流搜索引擎。
它的工作原理是计算机索引程序通过扫描文章中的每一个词，对每一个词建议一个索引，指明该词在文章中出现的次数和位置，当用户查询时，检索程序就根据事先建立的索引进行查找，并将查找的结果反馈给用户的检索方式。
使用这种检索方式软件或者产品我们称之为全文检索引擎。

## 主流开源的全文检索引擎

Lucene, Sphinx, Xapian, Nutch, DataparkSerch, ElasticSearch, ...

## ElasticSearch

`ElasticSearch` 是一个基于Apache Lucent(TM) 的开源搜索引擎。无论在开源还是专有领域,Lucene可以被认为是迄今为止最先进、性能最好的、功能最全的搜索引擎库。

`ElasticSearch` 也使用Java开发并使用Lucene作为其核心来实现所有索引和搜索的功能， 但是它的目的是通过简单的RESTful API 来隐藏Lucene的复杂性，从而让全文搜索变得简单。

* 分布式的实时文件存储，每个字段都被索引可被搜索
* 分布式的实时分析搜索引擎
* 可以扩展到上百台服务器，处理PB级结构化或非结构化数据
* 所有功能集成在一个服务里面，可以通过RESTful API、各种语言的客户端甚至命令与之交互
* 上手容易，提供很多合理的缺省值，开箱即用，学习成本低
* 可以免费下载、使用和修改
* 配置灵活