+++
title = '一条SQL语句是如何执行的'
date = 2024-05-03T14:55:05+08:00
draft = true
+++

![](/img/mysql/240.png)

## 连接器

起一个客户端的监听，监听客户端的请求，请求之后连接器的任务就完成了。接着就是将客户端的指令请求转发至缓存或分析器。

## 缓存

缓存会将之前执行过的语句以及结果会以KV的形式缓存在内存中。比如之前客户端执行过 “select * from t;”，那么 `K` 就是执行的SQL本身，`V` 就是查询的结果集。

缓存这一设计目的是好的，比如刚刚执行某个SQL查询，之后再使用就不需要再执行一遍，就可以将缓存过的结果返回就可以了。所以缓存的作用就是查询之前先查找之前执行过的相同语句。

但这也带了一些问题，就是缓存失效的问题，所以一般不推荐使用缓存，因为数据表修改后会删除所有相关缓存。生产环境上一个业务系统它的表的更新频率非常高。 

* MySQL 8.0 之后版本缓存功能已经移除

## 分析器

* 分析器的作用是分析你要 “干什么”
* 先做词法分析，识别SQL语句中的关键字

关键字比如 select, join， update等

* 再做句法分析，判断SQL语句是否符合语法

比如句子里面有个子查询，或者join连表，分析器就是分析出要干什么

## 优化器

* 优化器的作用你是要知道“怎么做”
* 优化器主要工作是决定如何使用索引 

## 执行器

