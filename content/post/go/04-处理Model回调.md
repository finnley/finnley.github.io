+++
title = '04-处理Model回调'
date = 2025-09-20T10:31:01+08:00
draft = true
categories = [ "Go" ]
tags = [ "go"]
+++

## 处理 model 回调

你会发现我们在编写 model 代码时，并没有针对我们的公共字段 created_on、modified_on、deleted_on、is_del 进行处理，难道不是在每一个 DB 操作中进行设置和修改吗？

显然，这在通用场景下并不是最好的方案，因为如果每一个 DB 操作都去设置公共字段的值，那么不仅多了很多重复的代码，在要调整公共字段时工作量也会翻倍。

我们可以采用设置 model callback 的方式去实现公共字段的处理，本项目使用的 ORM 库是 GORM，GORM 本身是提供回调支持的，因此我们可以根据自己的需要自定义 GORM 的回调操作，而在 GORM 中我们可以分别进行如下的回调相关行为：

注册一个新的回调。
删除现有的回调。
替换现有的回调。
注册回调的先后顺序。
在本项目中使用到的“替换现有的回调”这一行为，我们打开项目的 internal/model 目录下的 model.go 文件，准备开始编写 model 的回调代码，下述所新增的回调代码均写入在 NewDBEngine 方法后。